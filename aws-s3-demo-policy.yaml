
vars:

  long-description: &long-description |
      This policy will verify that S3 buckets are using encryption so that
      sensitive data is secure at rest. Many regulatory and compliance standards
      require data encryption to be enabled across resources. If any S3 buckets
      are found without encryption, the default server side encryption will be
      enabled and a notification sent. This policy helps with compliance
      standards such as APRA, GDPR, HIPAA, MAS, NIST 800-53 rev4 and PCI DSS by
      identifying and remediating the non-compliant S3 buckets.

  description: &description |
      S3 buckets which are not utilizing Server Side Encryption (SSE) will be
      identified, modified to use the aws/s3 KMS key, and the impacted users
      will be notified.

policies:
- name: aws-s3-demo-enable-encryption-20210222
  tags:
    - Category::Security
    - Compliance::APRA
    - Compliance::GDPR
    - Compliance::HIPAA
    - Compliance::MAS
    - Compliance::NIST 800-53
    - Compliance::PCI DSS
    - Risk::High
  resource: s3
  metadata:
    long-description: *long-description
  description: *description
  filters:
      - type: bucket-encryption
        state: False

- name: aws-ec2-demo-20210303
  tags:
    - Category::Cost
    - Compliance::HIPAA
    - Compliance::PCI DSS
    - Risk::Info
  resource: ec2
  metadata:
    long-description: This policy scans for all EC2 instances
  description: This policy scans for all RDS instances


- name: aws-rds-demo-20210303
  tags:
    - Category::Cost
    - Compliance::HIPAA
    - Compliance::MAS
    - Compliance::PCI DSS
    - Risk::Info
  resource: rds
  metadata:
    long-description: This policy scans for all RDS instances
  description: This policy scans for all RDS instances

- name: aws-codebuild-demo-20210303
  tags:
    - Category::Cost
    - Compliance::HIPAA
    - Compliance::PCI DSS
    - Risk::Info
  resource: codebuild
  metadata:
    long-description: This policy scans for all codebuild projects
  description: This policy scans for all codebuild projects


- name: aws-ecr-demo-20210303
  tags:
    - Category::Cost
    - Compliance::HIPAA
    - Compliance::MAS
    - Compliance::PCI DSS
    - Risk::Info
  resource: ecr
  metadata:
    long-description: This policy scans for all ecr instances
  description: This policy scans for all ecr instances

- name: aws-lambda-demo-20210303
  tags:
    - Category::Cost
    - Compliance::HIPAA
    - Compliance::PCI DSS
    - Risk::Info
  resource: lambda
  metadata:
    long-description: This policy scans for all lambda projects
  description: This policy scans for all lambda projects

- name: aws-step-machine-demo-20210303
  tags:
    - Category::Cost
    - Compliance::HIPAA
    - Compliance::MAS
    - Compliance::PCI DSS
    - Risk::Info
  resource: step-machine
  metadata:
    long-description: This policy scans for all step-machine instances
  description: This policy scans for all step-machine instances

